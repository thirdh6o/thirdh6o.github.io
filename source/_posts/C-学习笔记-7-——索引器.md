---
title: C#学习笔记(7)——索引器
date: 2026-01-17 12:33:35
tags:
- C#
categories:
- 学习笔记
description: 这是C#学习笔记的第七篇，介绍了索引器（Indexer）的概念和使用方法。
---
## 索引器（Indexer）
索引器（Indexer） 允许一个对象可以像数组一样使用下标的方式来访问。  
当您为类定义一个索引器时，该类的行为就会像一个 虚拟数组（virtual array） 一样。您可以使用数组访问运算符 [ ] 来访问该类的的成员。  
我们从一个例子入手.假设您有一个书架 BookShelf  
书架上放着几本书。你希望像访问数组一样：
- 第 0 本书：`shelf[0]`
- 把第 1 本书换掉：`shelf[1] = "..."`  

这就是索引器最直观的用途：让对象支持[]访问。  
最简单实现：内部用数组存书名
```csharp
class BookShelf
{
    private string[] books = new string[5];

    // 索引器：让 BookShelf 可以用 []
    public string this[int index]
    {
        get { return books[index]; }
        set { books[index] = value; }
    }
}
```
使用：
```csharp
var shelf = new BookShelf();

shelf[0] = "Harry Potter";
shelf[1] = "The Little Prince";

Console.WriteLine(shelf[0]); // Harry Potter
Console.WriteLine(shelf[1]); // The Little Prince
```
索引器的行为的声明在某种程度上类似于属性（property）。就像属性（property），您可使用 get 和 set 访问器来定义索引器。但是，属性返回或设置一个特定的数据成员，而索引器返回或设置对象实例的一个特定值。换句话说，它把实例数据分为更小的部分，并索引每个部分，获取或设置每个部分。
## 索引器语法
```csharp
element-type this[int index] 
{
   // get 访问器
   get 
   {
      // 返回 index 指定的值
   }

   // set 访问器
   set 
   {
      // 设置 index 指定的值 
   }
}
```
你也可以简写为：
```csharp
element-type this[int index] 
{
    get => books[index];
    set => books[index] = value;
}
```
## 索引器重载
索引器重载（Overloaded Indexer）：同一个类里定义了多个索引器，它们的区别靠 参数列表 来区分，就像方法重载一样。
在同一个类型中，你可以写多个：
```csharp
public T this[...]
```
只要它们的 参数类型/个数不同，编译器就能区分它们，这就叫索引器重载。  
注意：索引器本身没有名字（都是 this[...]），所以区分只能靠“参数签名”。
比如下面的例子中：
索引器 A：this[int index]（按下标访问，返回 string）
```csharp
public string this[int index]
{
    get { ... return namelist[index]; }
    set { ... namelist[index] = value; }
}
```
索引器 B：this[string name]（按名字查找，返回 int）：
```csharp
public int this[string name]
{
    get
    {
        int index = 0;
        while(index < size)
        {
            if (namelist[index] == name)
                return index;
            index++;
        }
        return index; // 没找到返回 size
    }
}
```
索引器A和B的使用：
```csharp
Console.WriteLine(namelist[i]); // 按下标访问
Console.WriteLine(namelist["张三"]); // 按名字查找
```
